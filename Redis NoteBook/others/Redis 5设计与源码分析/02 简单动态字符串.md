
简单动态字符串（Simple Dynamic String， SDS）是Redis的基本数据结构之一，用于存储字符串和整形数据。

SDS兼容C语言标准字符串处理函数，且在此基础上保证了二进制安全。



## 1 数据结构

- 思考：如果实现一个扩容方便且二进制安全的字符串？

二进制安全：通过某种机制，保证读写字符串时不损害其内容，则为二进制安全。如：C语言中，出现'\0'字符，会导致字符串被截断。

```c
struct sds {
    int len; // buf中已占用字节数
    int free; // buf中剩余可用字节数
    char buf[]; // 数据空间
}
```
在64位系统下，字段len和字段free哥占4个字节。

优点：
- 方便获取字符串长度
- 内容存放在柔性数组buf中，SDS对上层暴露的指针不是指向结构体SDS的指针，而是直接指向柔性数组buf的指针。上层可像读取C字符串一样读取SDS的内容，兼容C语言处理字符串的各种函数。
- 由于有长度统计变量len的存在，读写字符串时不依赖'\0'终止符，保证了二进制安全。



## 2 基本操作





## 3 小结